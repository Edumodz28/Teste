local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local Team = LocalPlayer.TeamColor

local ESPEnabled = true -- Definindo ESP como ativado por padrão

-- Velocidade do jogador (ajuste conforme necessário)
local PlayerSpeed = 50

-- Máximo de vida do jogador
local MaxHealth = 100

local function ESP(Player)
    if Player.TeamColor ~= Team then
        -- ESP Box
        local Box = Instance.new("BoxHandleAdornment")
        Box.Size = Player.Character.HumanoidRootPart.Size + Vector3.new(0.1, 0.1, 0.1)
        Box.Adornee = Player.Character.HumanoidRootPart
        Box.AlwaysOnTop = true
        Box.ZIndex = 5
        Box.Transparency = 0.5
        Box.Color3 = Color3.new(1, 0, 0)
        Box.Parent = Player.Character.HumanoidRootPart
        
        -- ESP Linha
        local Line = Instance.new("LineHandleAdornment")
        Line.From = LocalPlayer.Character.HumanoidRootPart.Position
        Line.To = Player.Character.HumanoidRootPart.Position
        Line.Color3 = Color3.new(1, 0, 0)
        Line.Parent = Player.Character.HumanoidRootPart
        
        -- ESP Vida
        local Billboard = Instance.new("BillboardGui")
        Billboard.Adornee = Player.Character.Head
        Billboard.Size = UDim2.new(2, 0, 2, 0)
        Billboard.StudsOffset = Vector3.new(0, 3, 0)
        Billboard.AlwaysOnTop = true
        Billboard.Parent = Player.Character.Head
        
        local HealthBar = Instance.new("Frame")
        HealthBar.Size = UDim2.new(1, 0, 0.2, 0)
        HealthBar.BackgroundColor3 = Color3.new(0, 1, 0)
        HealthBar.BorderSizePixel = 0
        HealthBar.Parent = Billboard
        
        local HealthLabel = Instance.new("TextLabel")
        HealthLabel.Size = UDim2.new(1, 0, 1, 0)
        HealthLabel.Position = UDim2.new(0, 0, 0, 0)
        HealthLabel.BackgroundColor3 = Color3.new(1, 1, 1)
        HealthLabel.BackgroundTransparency = 1
        HealthLabel.TextColor3 = Color3.new(1, 1, 1)
        HealthLabel.Text = tostring(MaxHealth)
        HealthLabel.Font = Enum.Font.SourceSans
        HealthLabel.Parent = HealthBar
        
        -- Conectar ao evento HealthChanged
        Player.Character.Humanoid.HealthChanged:Connect(function(health)
            HealthBar.Size = UDim2.new(health / MaxHealth, 0, 0.2, 0)
            HealthLabel.Text = tostring(math.floor(health))
        end)
    end
end

local function SetPlayerSpeed(speed)
    local character = LocalPlayer.Character
    if character then
        local humanoid = character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid.WalkSpeed = speed
        end
    end
end

local function TeleportAndDamage(Player)
    if Player.TeamColor ~= Team then
        local character = LocalPlayer.Character
        local targetCharacter = Player.Character
        if character and targetCharacter then
            local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
            local targetHumanoid = targetCharacter:FindFirstChildOfClass("Humanoid")
            local targetHumanoidRootPart = targetCharacter:FindFirstChild("HumanoidRootPart")
            if humanoidRootPart and targetHumanoidRootPart and targetHumanoid then
                humanoidRootPart.CFrame = targetHumanoidRootPart.CFrame
                targetHumanoid:TakeDamage(10) -- Altere o valor do dano conforme necessário
            end
        end
    end
end

local function RecoverHealth()
    LocalPlayer.Character.Humanoid.Health = MaxHealth
end

local function DisableESP()
    for _, Player in pairs(Players:GetPlayers()) do
        if Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
            local espAdornment = Player.Character.HumanoidRootPart:FindFirstChildOfClass("BoxHandleAdornment")
            local lineAdornment = Player.Character.HumanoidRootPart:FindFirstChildOfClass("LineHandleAdornment")
            local billboardGui = Player.Character:FindFirstChildOfClass("BillboardGui")
            if espAdornment then
                espAdornment:Destroy()
            end
            if lineAdornment then
                lineAdornment:Destroy()
            end
            if billboardGui then
                billboardGui:Destroy()
            end
        end
    end
end

local function OnDamaging(target)
    -- Aqui você pode adicionar o código para atingir o alvo
    print("Atacou o jogador: " .. target.Name)
end

Players.PlayerAdded:Connect(function(Player)
    ESP(Player)
end)

Players.PlayerRemoving:Connect(function(Player)
    if Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
        local espAdornment = Player.Character.HumanoidRootPart:FindFirstChildOfClass("BoxHandleAdornment")
        local lineAdornment = Player.Character.HumanoidRootPart:FindFirstChildOfClass("LineHandleAdornment")
        local billboardGui = Player.Character:FindFirstChildOfClass("BillboardGui")
        if espAdornment then
            espAdornment:Destroy()
        end
        if lineAdornment then
            lineAdornment:Destroy()
        end
        if billboardGui then
            billboardGui:Destroy()
        end
    end
end)

-- Ativando ESP ao iniciar o script
if ESPEnabled then
    for _, Player in pairs(Players:GetPlayers()) do
        ESP(Player)
    end
end

-- Ajustando a velocidade do jogador
SetPlayerSpeed(PlayerSpeed)

-- Teleportando e causando dano automaticamente para jogadores (exceto da mesma equipe)
while true do
    wait(1) -- Espera 1 segundo antes de teleportar novamente
    for _, Player in pairs(Players:GetPlayers()) do
        if Player.TeamColor ~= Team then
            TeleportAndDamage(Player)
        end
    end
end
